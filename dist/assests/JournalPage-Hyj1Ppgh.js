import{R as C,j as e,m as b,r as m,u as F,a as H,S as R}from"./index-4TWX89ZD.js";const z=({emotion:d})=>{const c=a=>a>75?"bg-green-500":a>50?"bg-yellow-400":a>25?"bg-orange-400":"bg-red-400";return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-24 text-sm font-medium text-text-secondary dark:text-dark-text-secondary capitalize truncate",children:d.emotion}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:`${c(d.score)} h-2.5 rounded-full transition-all duration-500`,style:{width:`${d.score}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-text-primary dark:text-dark-text-primary",children:[d.score,"%"]})]})},D=C.memo(({entry:d})=>{const{date:c,content:a,analysis:t}=d;let l=!1;try{const{useAuth:s}=require("../context/AuthContext"),{user:x}=s();l=!!(x!=null&&x.isPremium)}catch{l=!1}const n=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return e.jsxs(b.div,{className:"bg-white dark:bg-dark-surface p-6 rounded-xl shadow-md border border-gray-200 dark:border-dark-border transition-shadow duration-300",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300,damping:25},whileHover:{y:-5,boxShadow:"0px 10px 20px rgba(0,0,0,0.08)"},whileTap:{scale:.98},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-dark dark:text-brand-primary",children:n(c)}),t&&e.jsx("span",{className:`px-3 py-1 text-sm font-semibold rounded-full ${t.overallSentiment==="Positive"?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":t.overallSentiment==="Negative"?"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300"}`,children:t.overallSentiment})]}),e.jsx("p",{className:"text-text-secondary dark:text-dark-text-secondary leading-relaxed mb-6 whitespace-pre-wrap",children:a}),t&&e.jsxs("div",{className:"border-t border-gray-200 dark:border-dark-border pt-4",children:[e.jsxs("p",{className:"italic text-text-secondary dark:text-dark-text-secondary text-center mb-4",children:['"',t.summary,'"']}),e.jsx("div",{className:"space-y-3",children:t.emotions.slice(0,3).map(s=>e.jsx(z,{emotion:s},s.emotion))}),t.affirmation&&e.jsxs("div",{className:"mt-5 p-4 bg-brand-light dark:bg-dark-border rounded-lg flex items-center space-x-3 border-l-4 border-brand-primary",children:[e.jsx("i",{className:"fas fa-lightbulb-on text-2xl text-yellow-400"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-brand-dark dark:text-dark-text-primary",children:"A Thought For You"}),e.jsx("p",{className:"text-sm font-medium text-brand-dark dark:text-dark-text-secondary opacity-90",children:t.affirmation})]})]})]})]})}),L={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}},exit:{opacity:0,y:-20,transition:{duration:.3}}},j=()=>e.jsxs("div",{className:"bg-white dark:bg-dark-surface p-6 rounded-xl shadow-md border border-gray-200 dark:border-dark-border animate-pulse",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/4"})]}),e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6"})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-dark-border pt-4 mt-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mx-auto mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"})]})]})]}),T=()=>{var u,h,y,p,f;const[d,c]=m.useState(""),[a,t]=m.useState(5),l=m.useRef(null),{entries:n,isLoading:s,isFetching:x,error:g,addEntry:k}=F(),{user:r}=H();m.useEffect(()=>{const i=()=>{if(!l.current)return;const{scrollTop:S,scrollHeight:E,clientHeight:P}=l.current;E-S-P<100&&a<n.length&&t(A=>Math.min(A+5,n.length))},o=l.current;return o&&o.addEventListener("scroll",i),()=>{o&&o.removeEventListener("scroll",i)}},[a,n.length]);const N=((h=(u=r==null?void 0:r.name)==null?void 0:u.charAt(0))==null?void 0:h.toUpperCase())||((p=(y=r==null?void 0:r.email)==null?void 0:y.charAt(0))==null?void 0:p.toUpperCase())||"?",v=i=>{i.preventDefault();const o=d.replace(/<[^>]*>?/gm,"").trim();o&&k(o).then(()=>{c("")})},w=m.useMemo(()=>n.slice(0,a),[n,a]);return e.jsxs(b.div,{className:"max-w-4xl mx-auto",variants:L,initial:"hidden",animate:"visible",exit:"exit",children:[e.jsxs("header",{className:"mb-8 flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-brand-primary flex items-center justify-center text-white text-3xl font-bold shadow-md",children:r!=null&&r.profilePicture?e.jsx("img",{src:r.profilePicture,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{children:N})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold text-text-primary dark:text-dark-text-primary",children:["Hello, ",((f=r==null?void 0:r.name)==null?void 0:f.split(" ")[0])||"User","!"]}),e.jsx("p",{className:"text-lg text-text-secondary dark:text-dark-text-secondary mt-1",children:"Reflect on your day. Your thoughts are safe here."})]})]}),e.jsx("section",{className:"mb-12",children:e.jsxs("form",{onSubmit:v,className:"bg-white dark:bg-dark-surface p-6 rounded-xl shadow-lg border border-gray-200 dark:border-dark-border",children:[e.jsx("textarea",{"data-tour":"journal-input",value:d,onChange:i=>c(i.target.value),placeholder:"What's on your mind today?",className:"w-full h-32 p-4 bg-gray-50 dark:bg-dark-bg text-text-primary dark:text-dark-text-primary placeholder-gray-400 dark:placeholder-gray-500 border-2 border-gray-200 dark:border-dark-border rounded-lg focus:ring-2 focus:ring-brand-primary focus:border-transparent outline-none transition-all duration-200 text-lg",disabled:s}),g&&e.jsx("p",{className:"text-red-400 mt-2",children:g}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(b.button,{"data-tour":"journal-button",type:"submit",disabled:s||!d.trim(),className:"flex items-center justify-center px-6 py-3 bg-brand-primary text-white font-semibold rounded-lg shadow-md hover:bg-brand-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-primary transition-colors duration-300 disabled:bg-gray-500 disabled:cursor-not-allowed",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},children:s?e.jsxs(e.Fragment,{children:[e.jsx(R,{size:"5"}),e.jsx("span",{className:"ml-2",children:"Analyzing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-magic mr-2"}),e.jsx("span",{children:"Analyze My Day"})]})})})]})}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-text-primary dark:text-dark-text-primary mb-6 pb-2 border-b-2 border-gray-200 dark:border-dark-border",children:"Past Entries"}),e.jsx("div",{className:"space-y-6",children:x?e.jsxs(e.Fragment,{children:[e.jsx(j,{}),e.jsx(j,{})]}):n.length===0?e.jsxs("div",{className:"text-center py-12 bg-white dark:bg-dark-surface rounded-xl border-2 border-dashed border-gray-300 dark:border-dark-border",children:[e.jsx("i",{className:"fas fa-book-reader text-5xl text-gray-400 dark:text-gray-500"}),e.jsx("p",{className:"mt-4 text-text-secondary dark:text-dark-text-secondary text-lg",children:"No entries yet. Write your first one above!"})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{ref:l,style:{maxHeight:"70vh",overflowY:"auto"},children:[w.map(i=>e.jsx(D,{entry:i},i.id)),n.length>a&&e.jsx("div",{className:"flex justify-center items-center mt-8",children:e.jsx("span",{className:"text-gray-500",children:"Loading more..."})})]})})})]})]})};export{T as default};
